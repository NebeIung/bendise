// Comunas por región
const comunasPorRegion = {
    "Región Metropolitana de Santiago": [
        "Alhué",
        "Buin",
        "Calera de Tango",
        "Cerrillos",
        "Cerro Navia",
        "Colina",
        "Conchalí",
        "Curacaví",
        "El Bosque",
        "El Monte",
        "Estación Central",
        "Huechuraba",
        "Independencia",
        "Isla de Maipo",
        "La Cisterna",
        "La Florida",
        "La Granja",
        "La Pintana",
        "La Reina",
        "Lampa",
        "Las Condes",
        "Lo Barnechea",
        "Lo Espejo",
        "Lo Prado",
        "Macul",
        "Maipú",
        "María Pinto",
        "Melipilla",
        "Ñuñoa",
        "Padre Hurtado",
        "Pedro Aguirre Cerda",
        "Peñaflor",
        "Peñalolén",
        "Pirque",
        "Providencia",
        "Pudahuel",
        "Puente Alto",
        "Quilicura",
        "Quinta Normal",
        "Recoleta",
        "Renca",
        "San Bernardo",
        "San Joaquín",
        "San José de Maipo",
        "San Miguel",
        "San Pedro",
        "San Ramón",
        "Santiago",
        "Talagante",
        "Til Til",
        "Vitacura"
    ],
    "Región de Tarapacá": [
        "Iquique",
        "Pozo Almonte",
        "Alto Hospicio",
        "Pica",
        "Huara",
        "La Tirana",
        "Yape",
        "Pisagua"
    ],
    "Región de Arica y Parinacota": [
        "Arica"
    ],
    "Región de Antofagasta": [
        "Maria Elena",
        "Mejillones",
        "Taltal",
        "Sierra Gorda",
        "San Pedro de Atacama",
        "La Negra",
        "Calama",
        "Antofagasta",
        "Tocopilla"
    ],
    "Región de Atacama": [
        "Caldera",
        "Chanaral",
        "Paipote",
        "Tierra Amarilla",
        "El Salvador",
        "Diego de Almagro",
        "Huasco",
        "Freirina",
        "Bahia Inglesa",
        "Copiapó",
        "Vallenar"
    ],
    "Región de Coquimbo": [
        "Vicuna",
        "Guanaqueros",
        "Sotaqui",
        "El Paqui",
        "Monte Patria",
        "Chanaral Alto",
        "Combarbala",
        "Illapel",
        "Salamanca",
        "Andacollo",
        "La Higuera",
        "Canela",
        "Punitaqui",
        "Camarico",
        "Las Tacas",
        "Tierras Blancas",
        "Pichidangui",
        "Quilimari",
        "Guanguali",
        "Huentelauquen",
        "Altovalsol",
        "Gabriela Mistral",
        "La Marquesa",
        "El Molle",
        "El Tambo",
        "Los Hornos",
        "Las Dunas",
        "Puerto Velero",
        "El Penon",
        "Tambillo",
        "Huamalata",
        "Los Vilos",
        "Socos",
        "Cerrillos de Tamaya",
        "Pichicuy",
        "Caimanes",
        "Chillepin",
        "La Serena",
        "Coquimbo",
        "Ovalle"
    ],
    "Región de Valparaíso": [
        "Papudo",
        "Zapallar",
        "Llay Llay",
        "El Melon",
        "Catemu",
        "San Esteban",
        "Catapilco",
        "Las Cruces",
        "Cachagua",
        "El Tabo",
        "Maitencillo",
        "Isla Negra",
        "Puchuncavi",
        "San Sebastian",
        "Rinconada",
        "La Cruz",
        "Hijuelas",
        "Curauma",
        "Laguna Verde",
        "Belloto",
        "Quintero",
        "Santa Maria",
        "Penablanca",
        "Nogales",
        "Calle Larga",
        "Algarrobo",
        "Cartagena",
        "Llolleo",
        "Rocas de Santo Domingo",
        "Artificio",
        "Horcon",
        "Panqueue",
        "Putaendo",
        "La Dormida",
        "Petorca",
        "Quintay",
        "Las Ventanas",
        "Placilla",
        "Alicahue",
        "Punta de Tralca",
        "Matanzas",
        "Lagunillas",
        "Las Dichas",
        "El Sauce",
        "Tabolango",
        "San Pedro de Quillota",
        "Ocoa",
        "Boco de Quillota",
        "San Isidro de Quillota",
        "La Palma de Quillota",
        "La Retuca",
        "La Ligua",
        "Quilpue",
        "Longotoma",
        "San Antonio",
        "Olmue",
        "El Quisco",
        "La Calera",
        "Renaca",
        "Valparaíso",
        "Viña del Mar",
        "Villa Alemana",
        "Quillota",
        "San Felipe",
        "Los Andes",
        "Limache",
        "Concon",
        "Casablanca",
        "El Convento"
    ],
    "Región del Libertador General Bernardo O’Higgins": [
        "Graneros",
        "Requinoa",
        "Donihue",
        "Olivar Alto",
        "Codegua",
        "Coinco",
        "Lo Miranda",
        "Malloa",
        "Pelequen",
        "Las Cabras",
        "Pichidegua",
        "Peumo",
        "Quinta de Tilcoco",
        "San Vicente de Taguatagua",
        "Chimbarongo",
        "Cunaco",
        "Chepica",
        "Nancagua",
        "Rosario",
        "Palmilla",
        "Placilla",
        "San Francisco de Mostazal",
        "Coltauco",
        "Pichilemu",
        "La Estrella",
        "Litueche",
        "Coya",
        "Sewell",
        "Olivar Bajo",
        "Machali",
        "Santa Cruz",
        "Navidad",
        "Rancagua",
        "Rengo",
        "San Fernando"
    ],
    "Región del Maule": [
        "Maule",
        "San Clemente",
        "San Javier",
        "Villa Alegre",
        "Parral",
        "Teno",
        "Sagrada Familia",
        "Rio Claro",
        "Hualane",
        "Licanten",
        "Rauco",
        "Romeral",
        "Pelarco",
        "Pencahue",
        "San Rafael",
        "Colbun",
        "Yerbas Buenas",
        "Longavi",
        "Los Niches",
        "Rauquen",
        "Bobadilla",
        "Culenar",
        "Constitucion",
        "Cauquenes",
        "Molina",
        "Talca",
        "Curicó",
        "Linares"
    ],
    "Región del Biobío": [
        "Cabrero",
        "Carampangue",
        "Hualpencillo",
        "Curanilahue",
        "Laja",
        "Lebu",
        "Los Alamos",
        "Lota",
        "Mulchen",
        "Nacimiento",
        "Santa Barbara",
        "Arauco",
        "Yumbel",
        "El Carmen Chillan",
        "Lirquen",
        "Yungay",
        "Bulnes",
        "Pemuco",
        "Florida",
        "Colcura",
        "Contulmo",
        "Dichato",
        "Ranguelmo",
        "Hualqui",
        "Laraquete",
        "Monte Aguila",
        "Santa Clara",
        "Tucapel",
        "Nipas",
        "Trehuaco",
        "Viluco",
        "Charrua",
        "Campanario",
        "Ramadillas",
        "Vegas de Itata",
        "Cholguan",
        "Tanilvoro",
        "Rucapequen",
        "Quinchamali",
        "Pueblo Seco",
        "Nahueltoro",
        "Minas del Prado",
        "Cachapoal",
        "Los Horcones",
        "Coliumo",
        "Copiulemu",
        "Meipo",
        "Perales",
        "Guarilihue",
        "Checura",
        "Leonera",
        "Filomena",
        "Toroico",
        "Los Tilos",
        "Quillaitun",
        "Cerro Alto",
        "La Araucana",
        "Tres Pinos",
        "Antihuala",
        "Villa Los Rios",
        "Tome",
        "Penco",
        "Cañete",
        "Coronel",
        "Chiguayante",
        "Concepción",
        "Talcahuano",
        "Millantu",
        "Santa Fe",
        "Hualpen",
        "Los Angeles",
        "San Pedro de la Paz"
    ],
    "Región de La Araucanía": [
        "Temuco",
        "Pucon",
        "Villarrica",
        "Cajon",
        "Carahue",
        "Collipulli",
        "Curacautin",
        "Freire",
        "Gorbea",
        "Lautaro",
        "Loncoche",
        "los Sauces",
        "Nueva Imperial",
        "Pitrufquen",
        "Angol",
        "Traiguen",
        "Victoria",
        "Vilcun",
        "Galvarino",
        "Puerto Saavedra",
        "Cholchol",
        "Cunco",
        "Teodoro Schmidt",
        "Lonquimay",
        "Puren",
        "Tolten",
        "Lumaco",
        "Conaripe",
        "Licanray",
        "Capitan Pastene",
        "Quepe",
        "Padre Las Casas",
        "Labranza",
        "Metrenco",
        "Huiscapi",
        "San Ramon",
        "Quitratue",
        "Selva Oscura",
        "Lastarria"
    ],
    "Región de Los Lagos": [
        "Puerto Montt",
        "Calbuco",
        "Fresia",
        "Frutillar",
        "Purranque",
        "Los Muermos",
        "Rio Negro",
        "Llanquihue",
        "Quellon",
        "Puerto Octay",
        "Maullin",
        "San Pablo",
        "Alerce",
        "Nueva Braunau",
        "Carelmapu",
        "Entre Lagos",
        "San Juan de la Costa",
        "Trumao",
        "Pargua",
        "Pichi Pelluco",
        "Ahue",
        "Quetalmahue",
        "Lechagua",
        "Pauldeo",
        "Castro",
        "Puerto Varas",
        "Pucatrihue",
        "Puaucho",
        "Bahia Mansa",
        "Maicolpue",
        "Piedra Azul",
        "Quillaipe",
        "Metri",
        "Lenca",
        "Chaica",
        "La Arena",
        "Casma",
        "Osorno",
        "Chamiza",
        "El Yeco",
        "Panitao",
        "Ancud"
    ],
    "Región Aysén del General Carlos Ibáñez del Campo": [
        "Coyhaique",
        "Puerto Aysén"
    ],
    "Región de Magallanes y Antártica Chilena": [
        "Punta Arenas",
        "Puerto Natales",
        "San Gregorio"
    ],
    "Región de Los Ríos": [
        "Lago Ranco",
        "Tralcapulli",
        "Ancacomoe",
        "Pullinque",
        "Rio Trafun",
        "Llonguen",
        "Panguilelfun",
        "Puerto Fuy",
        "Cayumapu",
        "Punahue",
        "Playa Monje",
        "Los Cajones",
        "Los Tallos",
        "Huerquehue",
        "Melefquen",
        "Releco",
        "Llongahue",
        "Malalhue",
        "Paillaco",
        "Puerto Nuevo",
        "Lanco",
        "Los Lagos",
        "Panguipulli",
        "San Jose de la Mariquina",
        "Futrono",
        "Los Esteros",
        "Los Chilcos",
        "Valdivia",
        "La Union",
        "Río Bueno"
    ],
    "Región de Ñuble": [
        "Chillan",
        "San Carlos",
        "Coelemu",
        "Quillon",
        "Quirihue",
        "Coihueco",
        "Pinto",
        "San Ignacio",
        "San Nicolas",
        "Ninhue",
        "Portezuelo",
        "Ranquil"
    ]
};

// Ordenar comunas por región alfabéticamente
Object.keys(comunasPorRegion).forEach(region => {
    comunasPorRegion[region].sort((a, b) => a.localeCompare(b));
});

document.addEventListener('DOMContentLoaded', () => {
    const images = document.querySelectorAll('.carousel-image');
    const indicators = document.querySelectorAll('.indicator');
    const leftArrow = document.querySelector('.arrow-left');
    const rightArrow = document.querySelector('.arrow-right');
    let currentSlide = 0;
    let slideInterval;

    // Mostrar la imagen activa y el indicador correspondiente
    function showSlide(index) {
        images.forEach((img, i) => {
        img.classList.remove('active');
        if (i === index) {
            img.classList.add('active');
        }
        });
        indicators.forEach((indicator, i) => {
        indicator.classList.toggle('active', i === index);
        });
    }

    // Cambiar a la siguiente imagen
    function nextSlide() {
        currentSlide = (currentSlide + 1) % images.length;
        showSlide(currentSlide);
    }

    // Cambiar a la imagen anterior
    function previousSlide() {
        currentSlide = (currentSlide - 1 + images.length) % images.length;
        showSlide(currentSlide);
    }

    // Ir a una imagen específica al hacer clic en un indicador
    function goToSlide(index) {
        currentSlide = index;
        showSlide(currentSlide);
    }

    // Iniciar la rotación automática
    function startAutoSlide() {
        slideInterval = setInterval(nextSlide, 5000);
    }

    // Detener la rotación automática al interactuar
    function stopAutoSlide() {
        clearInterval(slideInterval);
    }

    // Agregar eventos a las flechas y los indicadores
    leftArrow.addEventListener('click', () => {
        stopAutoSlide();
        previousSlide();
        startAutoSlide();
    });

    rightArrow.addEventListener('click', () => {
        stopAutoSlide();
        nextSlide();
        startAutoSlide();
    });

    indicators.forEach((indicator, index) => {
        indicator.addEventListener('click', () => {
        stopAutoSlide();
        goToSlide(index);
        startAutoSlide();
        });
    });

    // Iniciar el carrusel
    showSlide(currentSlide);
    startAutoSlide();
    });

// Validación del RUT con dígito verificador
function validateRUT(rut) {
    rut = rut.replace(/\./g, '').replace('-', '');  // Eliminar puntos y guion
    const body = rut.slice(0, -1);
    const dv = rut.slice(-1).toUpperCase();  // Aceptar "K" y "k"

    // Cálculo del dígito verificador
    let suma = 0;
    let multiplo = 2;

    for (let i = body.length - 1; i >= 0; i--) {
        suma += multiplo * parseInt(body.charAt(i), 10);  // Convertir a entero
        multiplo = multiplo === 7 ? 2 : multiplo + 1;
    }

    const expectedDV = 11 - (suma % 11);
    const finalDV = expectedDV === 11 ? '0' : expectedDV === 10 ? 'K' : expectedDV.toString();

    return dv === finalDV;  // Devuelve true si el dígito verificador es correcto
}

document.getElementById("rutForm").addEventListener("submit", function (event) {
    event.preventDefault();
    const rut = document.getElementById("rut").value.replace(/\./g, '').replace('-', '');
    const rutError = document.getElementById("rutError");
    const rutInput = document.getElementById("rut");

    if (validateRUT(rut)) {
        rutError.textContent = "";
        rutInput.classList.remove("error");
        document.getElementById("extraFieldsSection").style.display = "block";
    } else {
        rutError.textContent = "Por favor ingrese un RUT válido con dígito verificador.";
        rutInput.classList.add("error");
    }
});

// Formateo del RUT en tiempo real mientras el usuario escribe
document.getElementById('rut').addEventListener('input', function () {
    let input = this.value.replace(/[^0-9kK]/g, '');  // Permitir solo dígitos y "K/k"
    this.value = formatRUT(input);  // Formatear el RUT
});

// Formatear RUT con puntos y guion
function formatRUT(rut) {
    const body = rut.slice(0, -1);  // Parte numérica
    const dv = rut.slice(-1);  // Dígito verificador

    let formattedBody = '';
    for (let i = 0; i < body.length; i++) {
        if (i > 0 && (body.length - i) % 3 === 0) {
            formattedBody += '.';  // Insertar punto cada 3 dígitos
        }
        formattedBody += body[i];
    }

    return dv ? `${formattedBody}-${dv}` : formattedBody;  // Agregar guion si hay DV
}

// Validación al enviar el formulario
document.getElementById('rutForm').addEventListener('submit', function (e) {
    e.preventDefault();  // Prevenir envío del formulario

    const rut = document.getElementById('rut').value.replace(/[^\dkK]/g, '');  // Limpiar y mantener K/k
    const rutError = document.getElementById('rutError');

    if (!validateRUT(rut)) {
        rutError.textContent = "RUT no válido";  // Mostrar error
        document.getElementById('rut').classList.add('error');  // Borde rojo en caso de error
    } else {
        rutError.textContent = "";  // Limpiar mensaje de error
        document.getElementById('rut').classList.remove('error');  // Quitar borde roj
    }
});

// Modificar el campo de teléfono para mantener el formato +56
document.getElementById('telefono').addEventListener('input', function (e) {
    let input = e.target.value.replace(/\D/g, '');
    if (input.length < 2) {
    input = '56';
    }
    if (input.length > 2) {
    input = input.slice(0, 2) + ' ' + input.slice(2); // Formato +56 XXXXXXXXX
    }
    if (input.length > 12) {
    input = input.slice(0, 12);
    }
    e.target.value = '+' + input;
    });

// Actualizar comunas al seleccionar región
document.getElementById('region').addEventListener('change', function() {
    const regionSeleccionada = this.value;
    const comunaSelect = document.getElementById('comuna');

    // Limpiar opciones de comuna
    comunaSelect.innerHTML = '<option value="">Seleccione una comuna</option>';

    // Agregar comunas según la región seleccionada
    if (comunasPorRegion[regionSeleccionada]) {
        comunasPorRegion[regionSeleccionada].forEach(comuna => {
            const option = document.createElement('option');
            option.value = comuna;
            option.textContent = comuna;
            comunaSelect.appendChild(option);
        });
    }
});

// Validación del teléfono con el formato +56 9XXXXXXXX
function validatePhone(phone) {
    const regex = /^\+56 9\d{8}$/;
    return regex.test(phone);
}

// Validación del email
function validateEmail(email) {
    const regex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
    return regex.test(email);
}

// Restringir caracteres en el campo de email
document.getElementById('email').addEventListener('input', function () {
    this.value = this.value.replace(/[^a-zA-Z0-9._%+-@]/g, '');
});

// Validación de los nombres y apellidos (solo letras)
function validateNames(name) {
    return /^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+$/.test(name);
}

// Restricción de caracteres en el campo de calle
document.getElementById('calle').addEventListener('input', function () {
    this.value = this.value.replace(/[^a-zA-Z0-9\.]/g, '');
});

// Restricción de caracteres en el campo de número
document.getElementById('numero').addEventListener('input', function () {
    this.value = this.value.replace(/[^a-zA-Z0-9]/g, '');
});

// Restricción de caracteres en el campo de referencia
document.getElementById('dptoCasa').addEventListener('input', function () {
    this.value = this.value.replace(/[^a-zA-Z0-9\.]/g, '');
});

// Restricción de caracteres en los campos de nombres y apellidos
document.getElementById('nombres').addEventListener('input', restrictToLetters);
document.getElementById('apellidos').addEventListener('input', restrictToLetters);

function restrictToLetters(event) {
    const regex = /^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]*$/;
    const inputField = event.target;
    if (!regex.test(inputField.value)) {
        inputField.value = inputField.value.replace(/[^a-zA-ZáéíóúÁÉÍÓÚñÑ\s]/g, '');
    }
}

// Validación de los campos adicionales
document.getElementById('extraFieldsForm').addEventListener('submit', function (e) {
    e.preventDefault();  // Prevenir envío
    const nombres = document.getElementById('nombres').value;
    const apellidos = document.getElementById('apellidos').value;
    const email = document.getElementById('email').value;
    const telefono = document.getElementById('telefono').value;
    
    let valid = true;

    // Validar nombres
    if (!validateNames(nombres)) {
        document.getElementById('nombresError').textContent = "Nombres solo pueden contener letras.";
        valid = false;
    } else {
        document.getElementById('nombresError').textContent = ""; // Limpiar mensaje
    }

    // Validar apellidos
    if (!validateNames(apellidos)) {
        document.getElementById('apellidosError').textContent = "Apellidos solo pueden contener letras.";
        valid = false;
    } else {
        document.getElementById('apellidosError').textContent = ""; // Limpiar mensaje
    }

    // Validar email
    if (!validateEmail(email)) {
        document.getElementById('emailError').textContent = "Email inválido.";
        valid = false;
    } else {
        document.getElementById('emailError').textContent = ""; // Limpiar mensaje
    }

    // Validar teléfono
    if (!validatePhone(telefono)) {
        document.getElementById('telefonoError').textContent = "Teléfono inválido.";
        valid = false;
    } else {
        document.getElementById('telefonoError').textContent = ""; // Limpiar mensaje
    }

    // Si todos los campos son válidos, mostrar la sección de entrega
    if (valid) {
        document.getElementById('extraFieldsSection').style.display = 'none'; // Ocultar datos personales
        document.getElementById('deliverySection').style.display = 'block'; // Mostrar entrega
    }
});

// Mostrar campos según tipo de entrega
document.getElementById('tipoEntrega').addEventListener('change', function () {
    const tipoEntrega = this.value;
    const domicilioFields = document.getElementById('domicilioFields');
    const sucursalFields = document.getElementById('sucursalFields');

    if (tipoEntrega === 'Domicilio') {
        domicilioFields.style.display = 'block';  // Mostrar campos de domicilio
        sucursalFields.style.display = 'none';     // Ocultar campos de sucursal
    } else if (tipoEntrega === 'Sucursal') {
        domicilioFields.style.display = 'none';     // Ocultar campos de domicilio
        sucursalFields.style.display = 'block';    // Mostrar campos de sucursal
    } else {
        domicilioFields.style.display = 'none';     // Ocultar ambos si no hay selección
        sucursalFields.style.display = 'none';
    }
});

// Funcionalidad del botón retroceder
document.getElementById('backButton').addEventListener('click', function () {
    document.getElementById('deliverySection').style.display = 'none'; // Ocultar entrega
    document.getElementById('extraFieldsSection').style.display = 'block'; // Volver a datos personales
});

// Funcionalidad del botón retroceder
document.getElementById('backButton2').addEventListener('click', function () {
    document.getElementById('resumenSection').style.display = 'none'; // Ocultar entrega
    document.getElementById('deliverySection').style.display = 'block'; // Volver a datos personales
});

// Lógica de flujo del formulario de entrega
document.getElementById('nextButton').addEventListener('click', function (e) {
    e.preventDefault();  // Evitar el comportamiento predeterminado

    const tipoEntrega = document.getElementById('tipoEntrega').value;
    const nombres = document.getElementById('nombres').value;
    const apellidos = document.getElementById('apellidos').value;

    // Validación de tipo de entrega
    if (!tipoEntrega) {
        alert("Por favor seleccione un tipo de entrega.");  // Mensaje si no se selecciona tipo
        return;
    }

    // Validar campos adicionales (solo si el tipo de entrega es "domicilio")
    if (tipoEntrega === 'Domicilio') {
        const calle = document.getElementById('calle').value;
        const numero = document.getElementById('numero').value;
        const referencia = document.getElementById('dptoCasa').value;  // Nuevo campo referencia
        const comuna = document.getElementById('comuna').value;
        const region = document.getElementById('region').value;

        let valid = true;

        if (!calle || !numero || !comuna || !region) {
            alert("Por favor complete todos los campos de dirección.");
            valid = false;
        }

        if (valid) {
            // Formatear la dirección con o sin referencia
            const direccion = referencia 
                ? `${calle}, ${numero}, ${referencia}, ${comuna}, ${region}` 
                : `${calle}, ${numero}, ${comuna}, ${region}`;

            // Mostrar resumen
            document.getElementById('resumenRut').textContent = document.getElementById('rut').value;
            document.getElementById('resumenNombre').textContent = `${nombres} ${apellidos}`;
            document.getElementById('resumenEmail').textContent = document.getElementById('email').value;
            document.getElementById('resumenTelefono').textContent = document.getElementById('telefono').value;
            document.getElementById('resumenTipo').textContent = `${tipoEntrega}`;
            document.getElementById('resumenDireccion').textContent = direccion;

            document.getElementById('deliverySection').style.display = 'none'; // Ocultar entrega
            document.getElementById('resumenSection').style.display = 'block'; // Mostrar resumen
        }
    } else if (tipoEntrega === 'Sucursal') {
        // Mostrar resumen para entrega en sucursal
        document.getElementById('resumenRut').textContent = document.getElementById('rut').value;
        document.getElementById('resumenNombre').textContent = `${nombres} ${apellidos}`;
        document.getElementById('resumenEmail').textContent = document.getElementById('email').value;
        document.getElementById('resumenTelefono').textContent = document.getElementById('telefono').value;
        document.getElementById('resumenDireccion').textContent = `Sucursal: ${document.getElementById('sucursal').value}`;

        document.getElementById('deliverySection').style.display = 'none'; // Ocultar entrega
        document.getElementById('resumenSection').style.display = 'block'; // Mostrar resumen
    }
});

// Lógica para mostrar SweetAlert al finalizar
document.getElementById('finalizarButton').addEventListener('click', function () {
    const rut = document.getElementById('rut').value;
    const nombres = document.getElementById('nombres').value;
    const apellidos = document.getElementById('apellidos').value;
    const email = document.getElementById('email').value;
    const telefono = document.getElementById('telefono').value;

    // Guardar datos en LocalStorage
    const clienteData = { nombres, apellidos, email, telefono };
    localStorage.setItem(rut, JSON.stringify(clienteData));

    // Mostrar mensaje de éxito y recargar página
    Swal.fire({
        title: '¡Ingreso exitoso!',
        text: 'Nos pondremos en contacto pronto para enviar su comprobante de ingreso.',
        icon: 'success',
        confirmButtonText: 'Aceptar'
    }).then((result) => {
        if (result.isConfirmed) {
            location.reload();  // Reiniciar la página
        }
    });
});

document.getElementById('nextButton').addEventListener('click', function (e) {
    e.preventDefault();  // Evitar recarga por defecto

    const rut = document.getElementById('rut').value;

    // Verificar si hay datos del cliente guardados
    const clienteData = JSON.parse(localStorage.getItem(rut));

    if (clienteData) {
        // Llenar los campos con los datos guardados
        document.getElementById('nombres').value = clienteData.nombres;
        document.getElementById('apellidos').value = clienteData.apellidos;
        document.getElementById('email').value = clienteData.email;
        document.getElementById('telefono').value = clienteData.telefono;

        Swal.fire({
            title: '¡Datos encontrados!',
            text: 'Los datos del cliente han sido cargados automáticamente.',
            icon: 'info',
            confirmButtonText: 'Continuar'
        });
    } else {
        Swal.fire({
            title: '¡Nuevo cliente!',
            text: 'Por favor ingrese sus datos.',
            icon: 'warning',
            confirmButtonText: 'Continuar'
        });
    }
});